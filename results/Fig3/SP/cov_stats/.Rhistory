# by accession_number onto this 3rd df
kobux2 <- join(kobu.manual, kobu.dat2, by = "Accession", match = "all",
type = "right")
View(kobux2)
amp_seq_merge <- join(amp_seq, pgcoe_metadat, by = "sample", match = "all",
type = "right")
# load in amplicon data
amp_seq <- read.csv("amplicon_seq_13JUN2024.csv",
header = T, stringsAsFactors = F)
library(gridExtra)
library(dplyr)
library(ggplot2)
library(tidyverse)
library(plyr)
library(wesanderson)
homewd= "/Users/flg9/Desktop/Developer/grubaugh_lab/snakemake_workflows/read_alignment/SP_alignment_13JUN2024/cov_stats/"
setwd(paste0(homewd))
# load in mNGS data
mNGS_seq <- read.csv("mNGS_seq_13JUN2024.csv",
header = T, stringsAsFactors = F)
# load in PGCOE metadata
pgcoe_metadat <- read.csv("PGCOE_DataSheet_13JUN2024.csv",
header = T, stringsAsFactors = F)
# load in amplicon data
amp_seq <- read.csv("amplicon_seq_13JUN2024.csv",
header = T, stringsAsFactors = F)
amp_seq_merge <- join(amp_seq, pgcoe_metadat, by = "sample", match = "all",
type = "right")
View(amp_seq_merge)
amp_seq_merge <- join(amp_seq, pgcoe_metadat, by = "sample", match = "all",
type = "left")
View(amp_seq_merge)
amp_seq_merge <- join(amp_seq, pgcoe_metadat, by = "sample", match = "all",
type = "full")
View(amp_seq_merge)
library(gridExtra)
library(dplyr)
library(ggplot2)
library(tidyverse)
library(plyr)
library(wesanderson)
homewd= "/Users/flg9/Desktop/Developer/grubaugh_lab/snakemake_workflows/read_alignment/SP_alignment_13JUN2024/cov_stats/"
setwd(paste0(homewd))
# load in mNGS data
mNGS_seq <- read.csv("mNGS_seq_13JUN2024.csv",
header = T, stringsAsFactors = F)
# load in PGCOE metadata
pgcoe_metadat <- read.csv("PGCOE_DataSheet_13JUN2024.csv",
header = T, stringsAsFactors = F)
# modify variable names in pgcoe dataset to match those of coverage data
pgcoe_metadat$sample <- str_replace(pgcoe_metadat$sample, ".*\\-", "")
# create new df to merge original PGCOE metadata to new coverage data
mNGS_seq_merge <- join(mGS_seq, pgcoe_metadat, by = "sample", match = "all",
type = "full")
# create new df to merge original PGCOE metadata to new coverage data
mNGS_seq_merge <- join(mNGS_seq, pgcoe_metadat, by = "sample", match = "all",
type = "full")
View(mNGS_seq_merge)
colnames(mNGS_seq_merge)
# sort sample ID order for plot
unique(mNGS_seq_merge$Original_ID) %>% sort
mNGS_seq_merge$Original_ID <- factor(mNGS_seq_merge$Original_ID,      # Reordering group factor levels
levels = c("A889-NP", "A889-S", "B042-NP",  "B042-S",
"C677-NP", "C677-S", "NTC3", "W1527-CI",
"W3317-CI", "W4034-CI"))
# plot coverage for samples from mNGS run
mNGS_seq_merge %>% ggplot() +
geom_point(aes(Original_ID, coverage, col = subsample)) +
ylab("Coverage (%)") + xlab("Sample ID")
mNGS_seq_merge %>%
ggplot() +
geom_point(aes(Ct1, coverage, col = Sample_Type.x), size = 4) +
#ylab("Coverage(%)") + xlab ("Ct") +
geom_hline(yintercept = 80, linetype = "dashed", color = "salmon") +
geom_text(x = max(mNGS_seq_merge$Ct1), y = 80, label = "80%", vjust = 2, hjust = 2, color = "black", size = 5) +
#scale_y_continuous(limits = c(-15, 105), breaks = c(0, 25, 50, 75, 100)) +
#scale_x_continuous(limits = c(0, 40), breaks = c(0, 10, 20, 30, 40)) +
scale_color_manual(values = wes_palette("Darjeeling2", 8, type = "continuous"))
## save mNGS merge to a csv
write.csv(mNGS_seq_merge, file = "mNGS_seq_13JUN2024.csv")
# load in amplicon data
amp_seq <- read.csv("amplicon_seq_13JUN2024.csv",
header = T, stringsAsFactors = F)
# create new df to merge original PGCOE metadata to new coverage data
amp_seq_merge <- join(amp_seq, pgcoe_metadat, by = "sample", match = "all",
type = "full")
# looks like two of the NEC samples aren't on the pgcoe metadata so those don't merge
# that's ok since we have plenty of other NECs and the missing ones didn't amplify anyways
unique(amp_seq$sample)
unique(amp_seq_merge$sample)
unique(amp_seq_merge$Original_ID.x)
unique(amp_seq_merge$Original_ID)
# plot coverage for samples from ampseq run
amp_seq_merge %>%
filter(Primer_Conc == "100uM" & subsample == "1.0" & (Sample_Dilution == 1e-03 | is.na(Sample_Dilution))) %>%
ggplot() +
geom_point(aes(Ct1, coverage, col = Sample_Type), size = 4) +
ylab("Coverage(%)") + xlab ("Ct") +
geom_hline(yintercept = 80, linetype = "dashed", color = "salmon") +
geom_text(x = max(amp_seq_merge$Ct1), y = 80, label = "80%", vjust = 2, hjust = 2, color = "black", size = 5) +
scale_y_continuous(limits = c(-15, 105), breaks = c(0, 25, 50, 75, 100)) +
scale_x_continuous(limits = c(0, 40), breaks = c(0, 10, 20, 30, 40)) +
scale_color_manual(values = wes_palette("Darjeeling2", 8, type = "continuous"))
# clean it up a bit
p1 <- amp_seq_merge %>%
filter(Primer_Conc == "100uM" & subsample == "1.0" & (Sample_Dilution == 1e-03 | is.na(Sample_Dilution)) &
(Sample_Type == "Culture enriched" | Sample_Type == "Culture isolate" | Sample_Type == "Saliva")) %>%
ggplot() +
geom_point(aes(Ct1, coverage, col = Sample_Type), size = 4) +
ylab("Coverage(%)") + xlab ("Ct") +
geom_hline(yintercept = 80, linetype = "dashed", color = "salmon") +
geom_text(x = max(amp_seq_merge$Ct1), y = 80, label = "80%", vjust = 2, hjust = 2, color = "black", size = 5) +
scale_y_continuous(limits = c(-15, 105), breaks = c(0, 25, 50, 75, 100)) +
scale_x_continuous(limits = c(0, 40), breaks = c(0, 10, 20, 30, 40)) +
scale_color_manual(values = wes_palette("Darjeeling2", 8, type = "continuous"))
p1
View(amp_seq_merge)
# plot coverage for samples from ampseq run
amp_seq_merge %>%
filter(Primer_Conc == "100uM" & subsample == "1.0" & (Sample_Dilution == 1e-03 | !is.na(Sample_Dilution))) %>%
ggplot() +
geom_point(aes(Ct1, coverage, col = Sample_Type), size = 4) +
ylab("Coverage(%)") + xlab ("Ct") +
geom_hline(yintercept = 80, linetype = "dashed", color = "salmon") +
geom_text(x = max(amp_seq_merge$Ct1), y = 80, label = "80%", vjust = 2, hjust = 2, color = "black", size = 5) +
scale_y_continuous(limits = c(-15, 105), breaks = c(0, 25, 50, 75, 100)) +
scale_x_continuous(limits = c(0, 40), breaks = c(0, 10, 20, 30, 40)) +
scale_color_manual(values = wes_palette("Darjeeling2", 8, type = "continuous"))
amp_seq_merge %>%
filter(Primer_Conc == "100uM" & subsample == "1.0" & (Sample_Dilution == 1e-03 | is.na(Sample_Dilution))) %>%
ggplot() +
geom_point(aes(Ct1, coverage, col = Sample_Type), size = 4)
amp_seq_merge %>%
filter(Primer_Conc == "100uM" & subsample == "1.0" & (Sample_Dilution == 1e-03 | is.na(Sample_Dilution)) &
(Sample_Type == "Culture enriched" | Sample_Type == "Culture isolate" | Sample_Type == "Saliva")) %>%
ggplot()
# looks like two of the NEC samples aren't on the pgcoe metadata so those don't merge
# that's ok since we have plenty of other NECs and the missing ones didn't amplify anyways
unique(amp_seq$sample)
unique(amp_seq_merge$sample)
unique(amp_seq_merge$Original_ID)
amp_seq_merge %>%
filter(Primer_Conc == "100uM" & subsample == "1.000" & (Sample_Dilution == 1e-03 | is.na(Sample_Dilution))) %>%
ggplot() +
geom_point(aes(Ct1, coverage, col = Sample_Type), size = 4) +
ylab("Coverage(%)") + xlab ("Ct") +
geom_hline(yintercept = 80, linetype = "dashed", color = "salmon") +
geom_text(x = max(amp_seq_merge$Ct1), y = 80, label = "80%", vjust = 2, hjust = 2, color = "black", size = 5) +
scale_y_continuous(limits = c(-15, 105), breaks = c(0, 25, 50, 75, 100)) +
scale_x_continuous(limits = c(0, 40), breaks = c(0, 10, 20, 30, 40)) +
scale_color_manual(values = wes_palette("Darjeeling2", 8, type = "continuous"))
# plot coverage for samples from ampseq run
amp_seq_merge %>%
ggplot() +
geom_point(aes(Ct1, coverage, col = Sample_Type), size = 4)
# plot coverage for samples from ampseq run
amp_seq_merge %>%
filter(Primer_Conc = "100uM") %>%
ggplot() +
geom_point(aes(Ct1, coverage, col = Sample_Type), size = 4)
# plot coverage for samples from ampseq run
amp_seq_merge %>%
filter(Primer_Conc == "100uM") %>%
ggplot() +
geom_point(aes(Ct1, coverage, col = Sample_Type), size = 4)
# plot coverage for samples from ampseq run
amp_seq_merge %>%
filter(Primer_Conc == "100uM" & subsample == "1.0") %>%
ggplot() +
geom_point(aes(Ct1, coverage, col = Sample_Type), size = 4)
# plot coverage for samples from ampseq run
amp_seq_merge %>%
filter(Primer_Conc == "100uM" & subsample == 1.0) %>%
ggplot() +
geom_point(aes(Ct1, coverage, col = Sample_Type), size = 4)
amp_seq_merge %>%
filter(Primer_Conc == "100uM" & subsample == 1.0 & (Sample_Dilution == 1e-03 | is.na(Sample_Dilution))) %>%
ggplot() +
geom_point(aes(Ct1, coverage, col = Sample_Type), size = 4) +
ylab("Coverage(%)") + xlab ("Ct") +
geom_hline(yintercept = 80, linetype = "dashed", color = "salmon") +
geom_text(x = max(amp_seq_merge$Ct1), y = 80, label = "80%", vjust = 2, hjust = 2, color = "black", size = 5) +
scale_y_continuous(limits = c(-15, 105), breaks = c(0, 25, 50, 75, 100)) +
scale_x_continuous(limits = c(0, 40), breaks = c(0, 10, 20, 30, 40)) +
scale_color_manual(values = wes_palette("Darjeeling2", 8, type = "continuous"))
# clean it up a bit
p1 <- amp_seq_merge %>%
filter(Primer_Conc == "100uM" & subsample == 1.0 & (Sample_Dilution == 1e-03 | is.na(Sample_Dilution)) &
(Sample_Type == "Culture enriched" | Sample_Type == "Culture isolate" | Sample_Type == "Saliva")) %>%
ggplot() +
geom_point(aes(Ct1, coverage, col = Sample_Type), size = 4) +
ylab("Coverage(%)") + xlab ("Ct") +
geom_hline(yintercept = 80, linetype = "dashed", color = "salmon") +
geom_text(x = max(amp_seq_merge$Ct1), y = 80, label = "80%", vjust = 2, hjust = 2, color = "black", size = 5) +
scale_y_continuous(limits = c(-15, 105), breaks = c(0, 25, 50, 75, 100)) +
scale_x_continuous(limits = c(0, 40), breaks = c(0, 10, 20, 30, 40)) +
scale_color_manual(values = wes_palette("Darjeeling2", 8, type = "continuous"))
p1
amp_seq_merge %>%
filter(Primer_Conc == "100uM" & subsample == 1.0 & (Sample_Dilution == 1e-03 | is.na(Sample_Dilution)) &
(Sample_Type == "Culture enriched" | Sample_Type == "Culture isolate" | Sample_Type == "Saliva")) %>%
ggplot() +
geom_point(aes(Ct1, coverage, col = Sample_Type), size = 4) +
ylab("Coverage(%)") + xlab ("Ct") +
geom_hline(yintercept = 80, linetype = "dashed", color = "salmon") +
geom_text(x = max(amp_seq_merge$Ct1), y = 80, label = "80%", vjust = 2, hjust = 2, color = "black", size = 5) +
scale_y_continuous(limits = c(-15, 105), breaks = c(0, 25, 50, 75, 100)) +
scale_x_continuous(limits = c(0, 40), breaks = c(0, 10, 20, 30, 40)) +
scale_color_manual(values = wes_palette("Darjeeling2", 8, type = "continuous"))
amp_seq_merge %>%
filter(Primer_Conc == "100uM" & subsample == 1.0 & (Sample_Dilution == 1e-03 | is.na(Sample_Dilution)) &
(Sample_Type == "Culture isolate")) %>%
ggplot() +
geom_point(aes(Ct1, coverage, col = Sample_Type), size = 4) +
ylab("Coverage(%)") + xlab ("Ct") +
geom_hline(yintercept = 80, linetype = "dashed", color = "salmon") +
geom_text(x = max(amp_seq_merge$Ct1), y = 80, label = "80%", vjust = 2, hjust = 2, color = "black", size = 5) +
scale_y_continuous(limits = c(-15, 105), breaks = c(0, 25, 50, 75, 100)) +
scale_x_continuous(limits = c(0, 40), breaks = c(0, 10, 20, 30, 40)) +
scale_color_manual(values = wes_palette("Darjeeling2", 8, type = "continuous"))
mNGS_seq_merge %>%
ggplot() +
geom_point(aes(Ct1, coverage, col = Sample_Type.x), size = 4) +
#ylab("Coverage(%)") + xlab ("Ct") +
geom_hline(yintercept = 80, linetype = "dashed", color = "salmon") +
geom_text(x = max(mNGS_seq_merge$Ct1), y = 80, label = "80%", vjust = 2, hjust = 2, color = "black", size = 5) +
#scale_y_continuous(limits = c(-15, 105), breaks = c(0, 25, 50, 75, 100)) +
#scale_x_continuous(limits = c(0, 40), breaks = c(0, 10, 20, 30, 40)) +
scale_color_manual(values = wes_palette("Darjeeling2", 8, type = "continuous"))
# plot coverage for samples from mNGS run
mNGS_seq_merge %>% ggplot() +
geom_point(aes(Original_ID, coverage, col = subsample)) +
ylab("Coverage (%)") + xlab("Sample ID")
mNGS_seq_merge %>%
ggplot() +
geom_point(aes(Ct1, coverage, col = Sample_Type.x), size = 4) +
#ylab("Coverage(%)") + xlab ("Ct") +
geom_hline(yintercept = 80, linetype = "dashed", color = "salmon") +
geom_text(x = max(mNGS_seq_merge$Ct1), y = 80, label = "80%", vjust = 2, hjust = 2, color = "black", size = 5) +
#scale_y_continuous(limits = c(-15, 105), breaks = c(0, 25, 50, 75, 100)) +
#scale_x_continuous(limits = c(0, 40), breaks = c(0, 10, 20, 30, 40)) +
scale_color_manual(values = wes_palette("Darjeeling2", 8, type = "continuous"))
mNGS_seq_merge %>%
filter(subsample == 1.0) %>%
ggplot() +
geom_point(aes(Ct1, coverage, col = Sample_Type.x), size = 4) +
#ylab("Coverage(%)") + xlab ("Ct") +
geom_hline(yintercept = 80, linetype = "dashed", color = "salmon") +
geom_text(x = max(mNGS_seq_merge$Ct1), y = 80, label = "80%", vjust = 2, hjust = 2, color = "black", size = 5) +
#scale_y_continuous(limits = c(-15, 105), breaks = c(0, 25, 50, 75, 100)) +
#scale_x_continuous(limits = c(0, 40), breaks = c(0, 10, 20, 30, 40)) +
scale_color_manual(values = wes_palette("Darjeeling2", 8, type = "continuous"))
mNGS_seq_merge %>%
filter(subsample == 1.0) %>%
ggplot() +
geom_point(aes(Ct1, coverage, col = Sample_Type.x), size = 4) +
#ylab("Coverage(%)") + xlab ("Ct") +
geom_hline(yintercept = 80, linetype = "dashed", color = "salmon") +
geom_text(x = max(mNGS_seq_merge$Ct1), y = 80, label = "80%", vjust = 2, hjust = 2, color = "black", size = 5) +
scale_y_continuous(limits = c(0, 100), breaks = c(0, 50, 100)) +
#scale_x_continuous(limits = c(0, 40), breaks = c(0, 10, 20, 30, 40)) +
scale_color_manual(values = wes_palette("Darjeeling2", 8, type = "continuous"))
mNGS_seq_merge %>%
filter(subsample == 1.0) %>%
ggplot() +
geom_point(aes(Ct1, coverage, col = Sample_Type.x), size = 4) +
#ylab("Coverage(%)") + xlab ("Ct") +
geom_hline(yintercept = 80, linetype = "dashed", color = "salmon") +
geom_text(x = max(mNGS_seq_merge$Ct1), y = 80, label = "80%", vjust = 2, hjust = 2, color = "black", size = 5) +
scale_y_continuous(limits = c(0, 100), breaks = c(0, 50, 100)) +
#scale_x_continuous(limits = c(0, 40), breaks = c(0, 10, 20, 30, 40)) +
scale_color_manual(values = wes_palette("Darjeeling2", 8, type = "continuous"))
amp_seq_merge %>%
filter(Primer_Conc == "100uM" & subsample == 1.0 & (Sample_Dilution == 1e-03 | is.na(Sample_Dilution)) &
(Sample_Type == "Culture isolate")) %>%
ggplot() +
geom_point(aes(Ct1, coverage, col = Sample_Type), size = 4) +
ylab("Coverage(%)") + xlab ("Ct") +
geom_hline(yintercept = 80, linetype = "dashed", color = "salmon") +
geom_text(x = max(amp_seq_merge$Ct1), y = 80, label = "80%", vjust = 2, hjust = 2, color = "black", size = 5) +
scale_y_continuous(limits = c(-15, 105), breaks = c(0, 25, 50, 75, 100)) +
scale_x_continuous(limits = c(0, 40), breaks = c(0, 10, 20, 30, 40)) +
scale_color_manual(values = wes_palette("Darjeeling2", 8, type = "continuous"))
mNGS_seq_merge %>%
filter(subsample == 1.0) %>%
ggplot() +
geom_point(aes(Ct1, coverage, col = Sample_Type.x), size = 4) +
#ylab("Coverage(%)") + xlab ("Ct") +
geom_hline(yintercept = 80, linetype = "dashed", color = "salmon") +
geom_text(x = max(mNGS_seq_merge$Ct1), y = 80, label = "80%", vjust = 2, hjust = 2, color = "black", size = 5) +
scale_y_continuous(limits = c(0, 100), breaks = c(0, 50, 100)) +
#scale_x_continuous(limits = c(0, 40), breaks = c(0, 10, 20, 30, 40)) +
scale_color_manual(values = wes_palette("Darjeeling2", 8, type = "continuous"))
combined_data <- bind_rows(amp_seq_merge, mNGS_seq_merge)
ggplot(combined_data) +
geom_point(aes(Ct1, coverage, col = Sample_Type), size = 4) +
ylab("Coverage(%)") + xlab ("Ct") +
geom_hline(yintercept = 80, linetype = "dashed", color = "salmon") +
geom_text(aes(x = max(Ct1), y = 80, label = "80%", vjust = 2, hjust = 2, color = "black", size = 5)) +
scale_y_continuous(limits = c(-15, 105), breaks = c(0, 25, 50, 75, 100)) +
scale_x_continuous(limits = c(0, 40), breaks = c(0, 10, 20, 30, 40)) +
scale_color_manual(values = wes_palette("Darjeeling2", 8, type = "continuous")) +
facet_wrap(~ Source)
ggplot(combined_data) +
geom_point(aes(Ct1, coverage, col = Sample_Type), size = 4)
View(combined_data)
ggplot(combined_data) +
geom_point(aes(Ct1, coverage, col = Sample_Type), size = 4) +
ylab("Coverage(%)") + xlab ("Ct") +
geom_hline(yintercept = 80, linetype = "dashed", color = "salmon") +
geom_text(aes(x = max(Ct1), y = 80, label = "80%", vjust = 2, hjust = 2, color = "black", size = 5)) +
scale_y_continuous(limits = c(-15, 105), breaks = c(0, 25, 50, 75, 100)) +
scale_x_continuous(limits = c(0, 40), breaks = c(0, 10, 20, 30, 40)) +
scale_color_manual(values = wes_palette("Darjeeling2", 8, type = "continuous")) +
facet_wrap(~ NGS_Prep_Method)
library(gridExtra)
library(dplyr)
library(ggplot2)
library(tidyverse)
library(plyr)
library(wesanderson)
homewd= "/Users/flg9/Desktop/Developer/grubaugh_lab/snakemake_workflows/read_alignment/SP_alignment_13JUN2024/cov_stats/"
setwd(paste0(homewd))
# load in mNGS data
mNGS_seq <- read.csv("mNGS_seq_13JUN2024.csv",
header = T, stringsAsFactors = F)
# load in PGCOE metadata
pgcoe_metadat <- read.csv("PGCOE_DataSheet_13JUN2024.csv",
header = T, stringsAsFactors = F)
# modify variable names in pgcoe dataset to match those of coverage data
pgcoe_metadat$sample <- str_replace(pgcoe_metadat$sample, ".*\\-", "")
# create new df to merge original PGCOE metadata to new coverage data
mNGS_seq_merge <- join(mNGS_seq, pgcoe_metadat, by = "sample", match = "all",
type = "full")
colnames(mNGS_seq_merge)
# sort sample ID order for plot
unique(mNGS_seq_merge$Original_ID) %>% sort
mNGS_seq_merge$Original_ID <- factor(mNGS_seq_merge$Original_ID,      # Reordering group factor levels
levels = c("A889-NP", "A889-S", "B042-NP",  "B042-S",
"C677-NP", "C677-S", "NTC3", "W1527-CI",
"W3317-CI", "W4034-CI"))
# plot coverage for samples from mNGS run
mNGS_seq_merge %>% ggplot() +
geom_point(aes(Original_ID, coverage, col = subsample)) +
ylab("Coverage (%)") + xlab("Sample ID")
mNGS_seq_merge %>%
ggplot() +
geom_point(aes(Ct1, coverage, col = Sample_Type.x), size = 4) +
#ylab("Coverage(%)") + xlab ("Ct") +
geom_hline(yintercept = 80, linetype = "dashed", color = "salmon") +
geom_text(x = max(mNGS_seq_merge$Ct1), y = 80, label = "80%", vjust = 2, hjust = 2, color = "black", size = 5) +
#scale_y_continuous(limits = c(-15, 105), breaks = c(0, 25, 50, 75, 100)) +
#scale_x_continuous(limits = c(0, 40), breaks = c(0, 10, 20, 30, 40)) +
scale_color_manual(values = wes_palette("Darjeeling2", 8, type = "continuous"))
# load in amplicon data
amp_seq <- read.csv("amplicon_seq_13JUN2024.csv",
header = T, stringsAsFactors = F)
# create new df to merge original PGCOE metadata to new coverage data
amp_seq_merge <- join(amp_seq, pgcoe_metadat, by = "sample", match = "all",
type = "full")
# looks like two of the NEC samples aren't on the pgcoe metadata so those don't merge
# that's ok since we have plenty of other NECs and the missing ones didn't amplify anyways
unique(amp_seq$sample)
unique(amp_seq_merge$sample)
unique(amp_seq_merge$Original_ID)
# plot coverage for samples from ampseq run
amp_seq_merge %>%
filter(Primer_Conc == "100uM" & subsample == 1.0 & (Sample_Dilution == 1e-03 | is.na(Sample_Dilution))) %>%
ggplot() +
geom_point(aes(Ct1, coverage, col = Sample_Type), size = 4) +
ylab("Coverage(%)") + xlab ("Ct") +
geom_hline(yintercept = 80, linetype = "dashed", color = "salmon") +
geom_text(x = max(amp_seq_merge$Ct1), y = 80, label = "80%", vjust = 2, hjust = 2, color = "black", size = 5) +
scale_y_continuous(limits = c(-15, 105), breaks = c(0, 25, 50, 75, 100)) +
scale_x_continuous(limits = c(0, 40), breaks = c(0, 10, 20, 30, 40)) +
scale_color_manual(values = wes_palette("Darjeeling2", 8, type = "continuous"))
# clean it up a bit
p1 <- amp_seq_merge %>%
filter(Primer_Conc == "100uM" & subsample == 1.0 & (Sample_Dilution == 1e-03 | is.na(Sample_Dilution)) &
(Sample_Type == "Culture enriched" | Sample_Type == "Culture isolate" | Sample_Type == "Saliva")) %>%
ggplot() +
geom_point(aes(Ct1, coverage, col = Sample_Type), size = 4) +
ylab("Coverage(%)") + xlab ("Ct") +
geom_hline(yintercept = 80, linetype = "dashed", color = "salmon") +
geom_text(x = max(amp_seq_merge$Ct1), y = 80, label = "80%", vjust = 2, hjust = 2, color = "black", size = 5) +
scale_y_continuous(limits = c(-15, 105), breaks = c(0, 25, 50, 75, 100)) +
scale_x_continuous(limits = c(0, 40), breaks = c(0, 10, 20, 30, 40)) +
scale_color_manual(values = wes_palette("Darjeeling2", 8, type = "continuous"))
p1
amp_seq_merge %>%
filter(Primer_Conc == "100uM" & subsample == 1.0 & (Sample_Dilution == 1e-03 | is.na(Sample_Dilution)) &
(Sample_Type == "Culture isolate")) %>%
ggplot() +
geom_point(aes(Ct1, coverage, col = Sample_Type), size = 4) +
ylab("Coverage(%)") + xlab ("Ct") +
geom_hline(yintercept = 80, linetype = "dashed", color = "salmon") +
geom_text(x = max(amp_seq_merge$Ct1), y = 80, label = "80%", vjust = 2, hjust = 2, color = "black", size = 5) +
scale_y_continuous(limits = c(-15, 105), breaks = c(0, 25, 50, 75, 100)) +
scale_x_continuous(limits = c(0, 40), breaks = c(0, 10, 20, 30, 40)) +
scale_color_manual(values = wes_palette("Darjeeling2", 8, type = "continuous"))
mNGS_seq_merge %>%
filter(subsample == 1.0) %>%
ggplot() +
geom_point(aes(Ct1, coverage, col = Sample_Type.x), size = 4) +
#ylab("Coverage(%)") + xlab ("Ct") +
geom_hline(yintercept = 80, linetype = "dashed", color = "salmon") +
geom_text(x = max(mNGS_seq_merge$Ct1), y = 80, label = "80%", vjust = 2, hjust = 2, color = "black", size = 5) +
scale_y_continuous(limits = c(0, 100), breaks = c(0, 50, 100)) +
#scale_x_continuous(limits = c(0, 40), breaks = c(0, 10, 20, 30, 40)) +
scale_color_manual(values = wes_palette("Darjeeling2", 8, type = "continuous"))
combined_data <- bind_rows(amp_seq_merge, mNGS_seq_merge)
ggplot(combined_data) +
geom_point(aes(Ct1, coverage, col = Sample_Type), size = 4) +
ylab("Coverage(%)") + xlab ("Ct") +
geom_hline(yintercept = 80, linetype = "dashed", color = "salmon") +
geom_text(aes(x = max(Ct1), y = 80, label = "80%", vjust = 2, hjust = 2, color = "black", size = 5)) +
scale_y_continuous(limits = c(-15, 105), breaks = c(0, 25, 50, 75, 100)) +
scale_x_continuous(limits = c(0, 40), breaks = c(0, 10, 20, 30, 40)) +
scale_color_manual(values = wes_palette("Darjeeling2", 8, type = "continuous")) +
facet_wrap(~ NGS_Prep_Method)
ggplot(combined_data) +
geom_point(aes(Ct1, coverage, col = Sample_Type), size = 4) +
ylab("Coverage(%)") + xlab ("Ct") +
geom_hline(yintercept = 80, linetype = "dashed", color = "salmon") +
geom_text(aes(x = max(Ct1), y = 80, label = "80%", vjust = 2, hjust = 2, color = "black", size = 5)) +
scale_y_continuous(limits = c(-15, 105), breaks = c(0, 25, 50, 75, 100)) +
scale_x_continuous(limits = c(0, 40), breaks = c(0, 10, 20, 30, 40)) +
scale_color_manual(values = wes_palette("Darjeeling2", 8, type = "continuous")) +
facet_wrap(~ Method)
ggplot(combined_data) +
geom_point(aes(Ct1, coverage, col = Sample_Type), size = 4) +
ylab("Coverage(%)") + xlab ("Ct") +
geom_hline(yintercept = 80, linetype = "dashed", color = "salmon") +
geom_text(aes(x = max(Ct1), y = 80, label = "80%", vjust = 2, hjust = 2, color = "black", size = 5)) +
scale_y_continuous(limits = c(-15, 105), breaks = c(0, 25, 50, 75, 100)) +
scale_x_continuous(limits = c(0, 40), breaks = c(0, 10, 20, 30, 40)) +
scale_color_manual(values = wes_palette("Darjeeling2", 9, type = "continuous")) +
facet_wrap(~ Method)
ggplot(combined_data) +
geom_point(aes(Ct1, coverage, col = Sample_Type), size = 4, position = position_jitter(width = 0.2)) +
ylab("Coverage(%)") + xlab ("Ct") +
geom_hline(yintercept = 80, linetype = "dashed", color = "salmon") +
geom_text(aes(x = max(Ct1), y = 80, label = "80%", vjust = 2, hjust = 2, color = "black", size = 5)) +
scale_y_continuous(limits = c(-15, 105), breaks = c(0, 25, 50, 75, 100)) +
scale_x_continuous(limits = c(0, 40), breaks = c(0, 10, 20, 30, 40)) +
scale_color_manual(values = wes_palette("Darjeeling2", 9, type = "continuous")) +
facet_wrap(~ Method)
ggplot(combined_data) +
geom_point(aes(Ct1, coverage, col = Sample_Type), size = 4) +
ylab("Coverage(%)") + xlab ("Ct") +
geom_hline(yintercept = 80, linetype = "dashed", color = "salmon") +
geom_text(aes(x = max(Ct1), y = 80, label = "80%", vjust = 2, hjust = 2, color = "black", size = 5)) +
scale_y_continuous(limits = c(-15, 105), breaks = c(0, 25, 50, 75, 100)) +
scale_x_continuous(limits = c(0, 40), breaks = c(0, 10, 20, 30, 40)) +
scale_color_manual(values = wes_palette("Darjeeling2", 9, type = "continuous")) +
facet_wrap(~ Method)
combined_data %>%
filter(subsample == 1.0) %>%
ggplot() +
geom_point(aes(Ct1, coverage, col = Sample_Type), size = 4) +
ylab("Coverage(%)") + xlab ("Ct") +
geom_hline(yintercept = 80, linetype = "dashed", color = "salmon") +
geom_text(aes(x = max(Ct1), y = 80, label = "80%", vjust = 2, hjust = 2, color = "black", size = 5)) +
scale_y_continuous(limits = c(-15, 105), breaks = c(0, 25, 50, 75, 100)) +
scale_x_continuous(limits = c(0, 40), breaks = c(0, 10, 20, 30, 40)) +
scale_color_manual(values = wes_palette("Darjeeling2", 9, type = "continuous")) +
facet_wrap(~ Method)
combined_data %>%
filter(Primer_Conc = 100uM) %>%
combined_data %>%
filter(Primer_Conc = "100uM") %>%
ggplot() +
geom_point(aes(Ct1, coverage, col = Sample_Type), size = 4) +
ylab("Coverage(%)") + xlab ("Ct") +
geom_hline(yintercept = 80, linetype = "dashed", color = "salmon") +
geom_text(aes(x = max(Ct1), y = 80, label = "80%", vjust = 2, hjust = 2, color = "black", size = 5)) +
scale_y_continuous(limits = c(-15, 105), breaks = c(0, 25, 50, 75, 100)) +
scale_x_continuous(limits = c(0, 40), breaks = c(0, 10, 20, 30, 40)) +
scale_color_manual(values = wes_palette("Darjeeling2", 9, type = "continuous")) +
facet_wrap(~ Method)
combined_data %>%
filter(Primer_Conc == "100uM") %>%
ggplot() +
geom_point(aes(Ct1, coverage, col = Sample_Type), size = 4) +
ylab("Coverage(%)") + xlab ("Ct") +
geom_hline(yintercept = 80, linetype = "dashed", color = "salmon") +
geom_text(aes(x = max(Ct1), y = 80, label = "80%", vjust = 2, hjust = 2, color = "black", size = 5)) +
scale_y_continuous(limits = c(-15, 105), breaks = c(0, 25, 50, 75, 100)) +
scale_x_continuous(limits = c(0, 40), breaks = c(0, 10, 20, 30, 40)) +
scale_color_manual(values = wes_palette("Darjeeling2", 9, type = "continuous")) +
facet_wrap(~ Method)
combined_data %>%
filter() %>%
ggplot() +
geom_point(aes(Ct1, coverage, col = Sample_Type), size = 4) +
ylab("Coverage(%)") + xlab ("Ct") +
geom_hline(yintercept = 80, linetype = "dashed", color = "salmon") +
geom_text(aes(x = max(Ct1), y = 80, label = "80%", vjust = 2, hjust = 2, color = "black", size = 5)) +
scale_y_continuous(limits = c(-15, 105), breaks = c(0, 25, 50, 75, 100)) +
scale_x_continuous(limits = c(0, 40), breaks = c(0, 10, 20, 30, 40)) +
scale_color_manual(values = wes_palette("Darjeeling2", 9, type = "continuous")) +
facet_wrap(~ Method)
combined_data %>%
ggplot() +
geom_point(aes(Ct1, coverage, col = Sample_Type), size = 4) +
ylab("Coverage(%)") + xlab ("Ct") +
geom_hline(yintercept = 80, linetype = "dashed", color = "salmon") +
geom_text(aes(x = max(Ct1), y = 80, label = "80%", vjust = 2, hjust = 2, color = "black", size = 5)) +
scale_y_continuous(limits = c(-15, 105), breaks = c(0, 25, 50, 75, 100)) +
scale_x_continuous(limits = c(0, 40), breaks = c(0, 10, 20, 30, 40)) +
scale_color_manual(values = wes_palette("Darjeeling2", 9, type = "continuous")) +
facet_wrap(~ Method)
